from dataclasses import dataclass

from ..interfaces import ILogisticsRepository
from ..errors import EntityNotFoundError
from ...domain import OrderId

@dataclass(frozen=True, kw_only=True, slots=True)
class AssembleOrderUseCase:
    repo: ILogisticsRepository

    def execute(self, order_id: OrderId) -> None:
        """
        Marks order as ready for delivery.
        """
        order = self.repo.get_order(order_id)
        if not order:
            raise EntityNotFoundError(entity_id=str(order_id), entity_type="Order")

        # Domain Logic: Validates order is not empty
        order.mark_assembled()
        
        self.repo.save_order(order)