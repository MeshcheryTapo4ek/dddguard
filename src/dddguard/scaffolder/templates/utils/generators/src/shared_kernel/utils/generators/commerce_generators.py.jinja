import uuid
from dataclasses import dataclass
from decimal import Decimal
from faker import Faker

fake = Faker()

@dataclass
class MoneyMock:
    amount: Decimal
    currency: str

@dataclass
class ProductMock:
    id: uuid.UUID
    sku: str
    name: str
    description: str
    price: MoneyMock
    category: str
    stock_qty: int

def generate_money(min_amount: int = 10, max_amount: int = 1000, currency: str = "USD") -> MoneyMock:
    """Helper to generate consistent money objects."""
    amount = Decimal(fake.random_int(min=min_amount, max=max_amount))
    # Add cents randomly
    if fake.boolean():
        amount += Decimal(fake.random_int(min=0, max=99)) / 100
    
    return MoneyMock(amount=amount, currency=currency)

def generate_product(**overrides) -> ProductMock:
    defaults = {
        "id": uuid.uuid4(),
        "sku": fake.ean13(),
        "name": fake.commerce_name(),
        "description": fake.sentence(nb_words=10),
        "price": generate_money(min_amount=50, max_amount=500),
        "category": fake.random_element(["Electronics", "Home", "Books", "Clothing"]),
        "stock_qty": fake.random_int(min=0, max=500)
    }
    data = {**defaults, **overrides}
    return ProductMock(**data)